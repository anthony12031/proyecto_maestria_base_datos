cluster name = slony_universidad;

#Ingenieria
node 1 admin conninfo = 'dbname = universidad host = 192.168.3.194 user = postgres password = 1234';

#Ciencias de la educacion
node 2 admin conninfo = 'dbname = universidad host = 192.168.3.4 user = postgres password = *Piv2017*';

#Medio Ambiente
node 3 admin conninfo = 'dbname = universidad host = 192.168.3.4 user = postgres password = *Piv2017*';

#se inicia el nodo maestro (medio ambiente para replicar en ingenieria)
init cluster (id = 3, comment = 'nodo maestro');

#se crea el set donde se guardaran las inscripciones y notas
create set (id = 3, origin = 3, comment = 'aqui van todas las tablas replicadas');

#se especifica la tabla inscribe donde se encuenta la informacion que va a ser la replicada
set add table (set id = 3, origin = 3, id = 1, fully qualified name = 'ciencias.inscribe', comment = 'mi tabla notas esquema ciencias');

#se especifica cual nodo sera el esclavo (en este caso el id 1 ingenieria)
store node (id = 1, comment = 'nodo esclavo', EVENT NODE = 3);

#se especifica que el esclavo puede comunicarse con el maestro y viceversa
store path (server = 3, client = 1, conninfo = 'dbname = universidad host = 192.168.3.194 user = postgres password = 1234');
store path (server = 1, client = 3, conninfo = 'dbname = universidad host = 192.168.3.4 user = postgres password = *Piv2017*');

#se especifica que se esta escuchando por si se produce algun cambio en la(s) tablas se genere un evento de escritura
#el esclavo escucha eventos del maestro
store listen (origin = 3, provider = 3, receiver = 1);
#el maestro escucha eventos del esclavo
store listen (origin = 1, provider = 1, receiver = 3);

#ahora se hace que ademas de ser maestro, sea el esclavo de ciencias de la educacion
subscribe set (id=2, provider = 2, receiver = 3, forward = yes);